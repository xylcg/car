{% extends "base.html" %}

{% block title %}é¦–é¡µ{% endblock %}

{% block content %}
    <h2 class="welcome-text">æ¬¢è¿ä½¿ç”¨åœè½¦ä½æ”¶è´¹ç³»ç»Ÿ</h2>

    <div class="actions">
        <form action="{{ url_for('entry') }}" method="post" class="card entry-card">
            <h3><i class="icon">ğŸš—</i> è½¦è¾†å…¥åœº</h3>
            <div class="form-group">
                <input type="text" name="plate_number" placeholder=" " required>
                <label>è¯·è¾“å…¥è½¦ç‰Œå·</label>
            </div>
            <button type="submit" class="btn-primary">ç¡®è®¤å…¥åœº</button>
        </form>

        <form action="{{ url_for('exit') }}" method="post" class="card exit-card">
            <h3><i class="icon">ğŸ›‘</i> è½¦è¾†å‡ºåœº</h3>
            <div class="form-group">
                <input type="text" name="plate_number" placeholder=" " required>
                <label>è¯·è¾“å…¥è½¦ç‰Œå·</label>
            </div>
            <button type="submit" class="btn-danger">ç¡®è®¤å‡ºåœº</button>
        </form>
    </div>

    <div class="stats">
        <div class="stat-card">
            <h3>ä»Šæ—¥å…¥åœº</h3>
            <p class="count" id="today-entry">0</p>
        </div>
        <div class="stat-card">
            <h3>ä»Šæ—¥æ”¶è´¹</h3>
            <p class="count" id="today-income">Â¥0</p>
        </div>
        <div class="stat-card">
            <h3>åœ¨åœºè½¦è¾†</h3>
            <p class="count" id="current-vehicles">0</p>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿç»Ÿè®¡æ•°æ®åŠ¨ç”»
        function animateValue(id, start, end, duration, prefix = '') {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = Math.floor(progress * (end - start) + start);
                obj.innerHTML = prefix + value;
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // é¡µé¢åŠ è½½åæ‰§è¡ŒåŠ¨ç”»
        document.addEventListener('DOMContentLoaded', function() {
            animateValue('today-entry', 0, 42, 2000);
            animateValue('today-income', 0, 1265, 2000, 'Â¥');
            animateValue('current-vehicles', 0, 18, 2000);

            // ä¸ºæ¬¢è¿æ–‡æœ¬æ·»åŠ åŠ¨ç”»
            const welcomeText = document.querySelector('.welcome-text');
            welcomeText.style.animation = 'fadeIn 1s ease-out, pulse 2s ease-in-out 1s 2';
        });
    </script>
{% endblock %}